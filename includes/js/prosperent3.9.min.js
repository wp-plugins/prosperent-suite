(function(){var f=950>jQuery(window).height()?600:750;tinymce.PluginManager.add("prosperent",function(a,d){function h(c){return c.replace(/\[(linker|prosper_store|prosper_search|prosperInsert|contentInsert|compare) ?([^\]]*)?\](.+)?\[\/(linker|prosper_store|prosper_search|prosperInsert|contentInsert|compare)\]/g,function(b,c,a,e){b=window.encodeURIComponent(c);content=window.encodeURIComponent(a);"linker"==b?a='<span class="prosperShort" title="'+b+("undefined"!=a&&"undefined"!=typeof a?" "+a.replace(/"/g,
""):"")+'" style="display:inline-block;text-decoration:underline;color:red;" data-sh-attr="'+b+'" data-sh-content="'+content+'" data-mce-resize="false" data-mce-placeholder="1">'+e+"</span>":(e=location.protocol+"//"+location.hostname+"/wp-content/plugins/prosperent-suite/includes/img/"+("compare"==b?"prosperInsert":b)+"Placeholder.png",a='<img class="prosperShort" title="'+b+("undefined"!==a&&"undefined"!=typeof a?" "+a.replace(/"/g,""):"")+'" alt="'+b+("undefined"!==a&&"undefined"!=typeof a?" "+
a.replace(/"/g,""):"")+'" src="'+e+'" data-sh-attr="'+b+'" data-sh-content="'+("undefined"!==content&&"undefined"!=typeof content&&null!==content?content:"")+'" data-mce-resize="false" data-mce-placeholder="1" />');return a})}function k(a){return a.replace(/(<(img|span) class="prosperShort" [^>]+>(<img[^<]+|[^<\/]+)?(<\/span>)?)/g,function(a,c,d,e,f){a=g(c,"data-sh-attr");d=g(c,"data-sh-content");return a?"["+a+" "+d+"]"+e+"[/"+a+"]":c})}function g(a,b){return(b=(new RegExp(b+'="([^"]+)"',"g")).exec(a))?
window.decodeURIComponent(b[1]):""}a.addCommand("linker",function(c,b){a.windowManager.open({file:d+"/../views/prosperlinker/autoLink.php",width:950,height:f});a.windowManager.setParams(b)});a.addCommand("prosperInsert",function(c,b){a.windowManager.open({file:d+"/../views/prosperinsert/productInsert.php",width:950,height:f});a.windowManager.setParams(b)});a.addCommand("contentInsert",function(c,b){a.windowManager.open({file:d+"/../views/prosperinsert/contentInsert.php",width:950,height:f});a.windowManager.setParams(b)});
a.addCommand("prosper_search",function(c,b){a.windowManager.open({file:d+"/../views/prospersearch/prosperSearch.php",width:525,height:225});a.windowManager.setParams(b)});a.addButton("prosperent",{title:"Prosperent ShortCodes",type:"splitbutton",onclick:function(){},menu:[{text:"Link Phrase/Image to a Product",onclick:function(){a.execCommand("linker","","")}},{text:"Insert Products",hidden:!prosperSuiteVars.prosperInsert,onclick:function(){a.execCommand("prosperInsert","","")}},{text:"Edit Automated ProsperInsert Products",
hidden:!prosperSuiteVars.prosperInsert||!prosperSuiteVars.contentInsert||"all"!=prosperSuiteVars.contentInsert&&prosperSuiteVars.currentScreen!=prosperSuiteVars.contentInsert,onclick:function(){a.execCommand("contentInsert","","")}},{text:"Insert a Product Search Bar",onclick:function(){a.execCommand("prosper_search","","")}},{text:"Insert a Shop",hidden:"post"==prosperSuiteVars.currentScreen,onclick:function(){a.execCommand("mceInsertContent",!1,"[prosper_store][/prosper_store]")}}]});a.on("DblClick",
function(c){c.target.className.indexOf("prosperShort");if(-1<c.target.className.indexOf("prosperShort")){var b=c.target.attributes["data-sh-attr"].value,b=window.decodeURIComponent(b);c=c.target.attributes["data-sh-content"].value;c=window.decodeURIComponent(c);a.execCommand(b,"",c)}});a.on("GetContent",function(a){"undefined"!=a.content&&"undefined"!=typeof a.content&&null!==a.content&&(a.content=k(a.content))});a.on("BeforeSetcontent",function(a){"undefined"!=typeof a.content&&null!==a.content&&
(a.content=h(a.content))})})})();